---
services:
  gluetun:
    image: 'qmcgaw/gluetun:latest'
    container_name: gluetun
    networks:
      - gluetun
    cap_add:
      - NET_ADMIN
    ports:
      - 7878:7878/tcp
      - 8080:8080/tcp
      - 8686:8686/tcp
      - 8787:8787/tcp
      - 9117:9117/tcp
      - 8090:8090/tcp
      - 5076:5076/tcp
      - 444:444/tcp
      - 8989:8989/tcp
      - 9091:9091/tcp
    environment:
      - PUID=1027
      - PGID=100
      - TZ=Australia/Sydney
      - VPN_SERVICE_PROVIDER=private internet access
      - OPENVPN_USER=${OPENVPN_USER}
      - OPENVPN_PASSWORD=${OPENVPN_PASSWORD}
      - SERVER_REGIONS=Switzerland
      - VPN_PORT_FORWARDING=on
      - VPN_PORT_FORWARDING_STATUS_FILE=/gluetun/portfwd
      - UPDATER_VPN_SERVICE_PROVIDER=private internet access
      - UPDATE_PERIOD=24h
      - BLOCK_MALICIOUS=on
      - BLOCK_SURVEILLANCE=on
      - BLOCK_ADS=on
      - HTTPPROXY=off
      - SHADOWSOCKS=off
    volumes:
      - '/volume1/dkrcfg/gluetun:/gluetun'
    restart: always
    security_opt:
      - no-new-privileges:true
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:9999"]
      interval: 30s
      timeout: 10s
      retries: 5
      start_period: 20s
  nzbhydra:
    image: 'lscr.io/linuxserver/nzbhydra2:latest'
    container_name: nzbhydra
    depends_on:
      gluetun:
        condition: service_healthy
    network_mode: "service:gluetun"
    environment:
      - PUID=1027
      - PGID=100
      - TZ=Australia/Sydney
    volumes:
      - '/volume1/dkrcfg/nzbhydra:/config'
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5076"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
  jackett:
    image: 'lscr.io/linuxserver/jackett:latest'
    container_name: jackett
    depends_on:
      gluetun:
        condition: service_healthy
    network_mode: "service:gluetun"
    environment:
      - PUID=1027
      - PGID=100
      - TZ=Australia/Sydney
    volumes:
      - '/volume1/dkrcfg/jackett:/config'
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9117"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
  sabnzbd:
    image: 'lscr.io/linuxserver/sabnzbd:latest'
    container_name: sabnzbd
    depends_on:
      gluetun:
        condition: service_healthy
    network_mode: "service:gluetun"
    environment:
      - PUID=1027
      - PGID=100
      - TZ=Australia/Sydney
    volumes:
      - '/volume1/dkrcfg/sabnzbd:/config'
      - '/volume1/downloads:/downloads'
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
  transmission:
    image: 'lscr.io/linuxserver/transmission:latest'
    container_name: transmission
    depends_on:
      gluetun:
        condition: service_healthy
    network_mode: "service:gluetun"
    environment:
      - PUID=1027
      - PGID=100
      - TZ=Australia/Sydney
      - USER=${TRANSMISSION_USER}
      - PASS=${TRANSMISSION_PASS}
      - FILE__PEERPORT=/volume1/dkrcfg/gluetun/portfwd
    volumes:
      - '/volume1/dkrcfg/transmission:/config'
      - '/volume1/downloads:/downloads'
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9091"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
  sonarr:
    image: 'lscr.io/linuxserver/sonarr:latest'
    container_name: sonarr
    depends_on:
      gluetun:
        condition: service_healthy
    network_mode: "service:gluetun"
    environment:
      - PUID=1027
      - PGID=100
      - TZ=Australia/Sydney
    volumes:
      - '/volume1/TV:/tv'
      - '/volume1/dkrcfg/sonarr:/config'
      - '/volume1/downloads:/downloads'
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8989/ping"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 90s
  radarr:
    image: 'lscr.io/linuxserver/radarr:latest'
    container_name: radarr
    depends_on:
      gluetun:
        condition: service_healthy
    network_mode: "service:gluetun"
    environment:
      - PUID=1027
      - PGID=100
      - TZ=Australia/Sydney
    volumes:
      - '/volume1/Movies:/movies'
      - '/volume1/dkrcfg/radarr:/config'
      - '/volume1/downloads:/downloads'
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:7878/ping"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 90s
  lidarr:
    image: 'lscr.io/linuxserver/lidarr:latest'
    container_name: lidarr
    depends_on:
      gluetun:
        condition: service_healthy
    network_mode: "service:gluetun"
    environment:
      - PUID=1027
      - PGID=100
      - TZ=Australia/Sydney
    volumes:
      - '/volume1/Music:/music'
      - '/volume1/dkrcfg/lidarr:/config'
      - '/volume1/downloads:/downloads'
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8686/ping"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 90s
  mylar:
    image: 'lscr.io/linuxserver/mylar3:latest'
    container_name: mylar
    depends_on:
      gluetun:
        condition: service_healthy
    network_mode: "service:gluetun"
    environment:
      - PUID=1027
      - PGID=100
      - TZ=Australia/Sydney
    volumes:
      - '/volumeUSB1/usbshare/comics:/comics'
      - '/volume1/dkrcfg/mylar:/config'
      - '/volume1/downloads:/downloads'
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8090"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
  readarr:
    image: 'lscr.io/linuxserver/readarr:nightly-0.4.19.2811-ls400'
    container_name: readarr
    depends_on:
      gluetun:
        condition: service_healthy
    network_mode: "service:gluetun"
    environment:
      - PUID=1027
      - PGID=100
      - TZ=Australia/Sydney
    volumes:
      - '//volumeUSB1/usbshare/books:/books'
      - '/volume1/dkrcfg/readarr:/config'
      - '/volume1/downloads:/downloads'
    restart: always
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8787/ping"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 90s
networks:
  gluetun: null
