---
name: Deploy to Portainer

"on":
  push:
    branches:
      - main
    paths:
      - 'stack/**'
      - '.github/workflows/portainer-deploy.yml'
  workflow_dispatch:

jobs:
  trigger-portainer-webhook:
    name: Trigger Portainer GitOps Webhook
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Trigger Portainer Webhook
        run: |
          echo "ğŸš€ Triggering Portainer GitOps deployment..."
          curl -X POST \
            https://portainer.ambitiouscake.com/api/stacks/webhooks/4f7abd30-2e9e-48b4-959d-a017254bf532
          echo "âœ… Portainer webhook triggered successfully"

      - name: Deployment notification
        run: |
          echo "ğŸ“¦ Stack deployment initiated via Portainer"
          echo "ğŸ” Check Portainer UI for deployment status"
          echo "ğŸŒ Portainer URL: https://portainer.ambitiouscake.com"
